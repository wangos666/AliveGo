{"ast":null,"code":"import { createWebHistory, createRouter } from 'vue-router';\nimport routes from './routes';\nimport useUserStore from '@/store/User';\nimport { storeToRefs } from 'pinia';\nconst history = createWebHistory();\nconst router = createRouter({\n  history,\n  routes,\n\n  scrollBehavior(to, from, savedPosition) {\n    // 始终滚动到顶部\n    return {\n      top: 0\n    };\n  }\n\n});\nrouter.beforeEach(async (to, from, next) => {\n  const store = useUserStore();\n  let name = store.$state.userInfo?.name;\n\n  if (store.$state.token) {\n    if (to.path === '/login') {\n      if (to.meta.title) {\n        document.title = to.meta.title;\n      }\n\n      next('/');\n    } else {\n      if (name) {\n        if (to.meta.title) {\n          document.title = to.meta.title;\n        }\n\n        next();\n      } else {\n        try {\n          await store.getUserInfo();\n\n          if (to.meta.title) {\n            document.title = to.meta.title;\n          }\n\n          next();\n        } catch (error) {\n          await store.outLogin();\n\n          if (to.meta.title) {\n            document.title = to.meta.title;\n          }\n\n          next('/login');\n        }\n      }\n    }\n  } else {\n    if (to.path == '/pay' || to.path == '/paySuccess' || to.path == '/trade' || to.path == '/center' || to.path == '/center/myorder' || to.path == '/center/grouporder') {\n      next('/login');\n    } else {\n      if (to.meta.title) {\n        document.title = to.meta.title;\n      }\n\n      next();\n    }\n  }\n});\nexport default router;","map":{"version":3,"names":["createWebHistory","createRouter","routes","useUserStore","storeToRefs","history","router","scrollBehavior","to","from","savedPosition","top","beforeEach","next","store","name","$state","userInfo","token","path","meta","title","document","getUserInfo","error","outLogin"],"sources":["D:/web/Vue/shop/src/router/index.js"],"sourcesContent":["import { createWebHistory, createRouter } from 'vue-router'\r\nimport routes from './routes'\r\nimport useUserStore from '@/store/User'\r\nimport { storeToRefs } from 'pinia';\r\nconst history = createWebHistory();\r\nconst router = createRouter({\r\n    history,\r\n    routes,\r\n    scrollBehavior(to, from, savedPosition) {\r\n        // 始终滚动到顶部\r\n        return { top: 0 }\r\n    },\r\n})\r\nrouter.beforeEach(async (to, from, next) => {\r\n    const store = useUserStore()\r\n    let name = store.$state.userInfo?.name\r\n    if (store.$state.token) {\r\n        if (to.path === '/login') {\r\n            if (to.meta.title) {\r\n                document.title = to.meta.title\r\n            }\r\n            next('/')\r\n        } else {\r\n            if (name) {\r\n                if (to.meta.title) {\r\n                    document.title = to.meta.title\r\n                }\r\n                next()\r\n            } else {\r\n                try {\r\n                    await store.getUserInfo()\r\n                    if (to.meta.title) {\r\n                        document.title = to.meta.title\r\n                    }\r\n                    next()\r\n                } catch (error) {\r\n                    await store.outLogin()\r\n                    if (to.meta.title) {\r\n                        document.title = to.meta.title\r\n                    }\r\n                    next('/login')\r\n                }\r\n            }\r\n\r\n        }\r\n    } else {\r\n        if (to.path == '/pay' || to.path == '/paySuccess' || to.path == '/trade' || to.path == '/center' || to.path == '/center/myorder' || to.path == '/center/grouporder') {\r\n            next('/login')\r\n        } else {\r\n            if (to.meta.title) {\r\n                document.title = to.meta.title\r\n            }\r\n            next()\r\n        }\r\n\r\n    }\r\n\r\n\r\n})\r\nexport default router\r\n"],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,YAA3B,QAA+C,YAA/C;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,YAAP,MAAyB,cAAzB;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,MAAMC,OAAO,GAAGL,gBAAgB,EAAhC;AACA,MAAMM,MAAM,GAAGL,YAAY,CAAC;EACxBI,OADwB;EAExBH,MAFwB;;EAGxBK,cAAc,CAACC,EAAD,EAAKC,IAAL,EAAWC,aAAX,EAA0B;IACpC;IACA,OAAO;MAAEC,GAAG,EAAE;IAAP,CAAP;EACH;;AANuB,CAAD,CAA3B;AAQAL,MAAM,CAACM,UAAP,CAAkB,OAAOJ,EAAP,EAAWC,IAAX,EAAiBI,IAAjB,KAA0B;EACxC,MAAMC,KAAK,GAAGX,YAAY,EAA1B;EACA,IAAIY,IAAI,GAAGD,KAAK,CAACE,MAAN,CAAaC,QAAb,EAAuBF,IAAlC;;EACA,IAAID,KAAK,CAACE,MAAN,CAAaE,KAAjB,EAAwB;IACpB,IAAIV,EAAE,CAACW,IAAH,KAAY,QAAhB,EAA0B;MACtB,IAAIX,EAAE,CAACY,IAAH,CAAQC,KAAZ,EAAmB;QACfC,QAAQ,CAACD,KAAT,GAAiBb,EAAE,CAACY,IAAH,CAAQC,KAAzB;MACH;;MACDR,IAAI,CAAC,GAAD,CAAJ;IACH,CALD,MAKO;MACH,IAAIE,IAAJ,EAAU;QACN,IAAIP,EAAE,CAACY,IAAH,CAAQC,KAAZ,EAAmB;UACfC,QAAQ,CAACD,KAAT,GAAiBb,EAAE,CAACY,IAAH,CAAQC,KAAzB;QACH;;QACDR,IAAI;MACP,CALD,MAKO;QACH,IAAI;UACA,MAAMC,KAAK,CAACS,WAAN,EAAN;;UACA,IAAIf,EAAE,CAACY,IAAH,CAAQC,KAAZ,EAAmB;YACfC,QAAQ,CAACD,KAAT,GAAiBb,EAAE,CAACY,IAAH,CAAQC,KAAzB;UACH;;UACDR,IAAI;QACP,CAND,CAME,OAAOW,KAAP,EAAc;UACZ,MAAMV,KAAK,CAACW,QAAN,EAAN;;UACA,IAAIjB,EAAE,CAACY,IAAH,CAAQC,KAAZ,EAAmB;YACfC,QAAQ,CAACD,KAAT,GAAiBb,EAAE,CAACY,IAAH,CAAQC,KAAzB;UACH;;UACDR,IAAI,CAAC,QAAD,CAAJ;QACH;MACJ;IAEJ;EACJ,CA7BD,MA6BO;IACH,IAAIL,EAAE,CAACW,IAAH,IAAW,MAAX,IAAqBX,EAAE,CAACW,IAAH,IAAW,aAAhC,IAAiDX,EAAE,CAACW,IAAH,IAAW,QAA5D,IAAwEX,EAAE,CAACW,IAAH,IAAW,SAAnF,IAAgGX,EAAE,CAACW,IAAH,IAAW,iBAA3G,IAAgIX,EAAE,CAACW,IAAH,IAAW,oBAA/I,EAAqK;MACjKN,IAAI,CAAC,QAAD,CAAJ;IACH,CAFD,MAEO;MACH,IAAIL,EAAE,CAACY,IAAH,CAAQC,KAAZ,EAAmB;QACfC,QAAQ,CAACD,KAAT,GAAiBb,EAAE,CAACY,IAAH,CAAQC,KAAzB;MACH;;MACDR,IAAI;IACP;EAEJ;AAGJ,CA7CD;AA8CA,eAAeP,MAAf"},"metadata":{},"sourceType":"module"}