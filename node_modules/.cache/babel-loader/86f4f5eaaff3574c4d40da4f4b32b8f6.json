{"ast":null,"code":"const __default__ = {\n  name: 'ShopCart'\n};\nimport useShopcartStore from '@/store/Shopcart';\nimport useDetailStore from '@/store/Detail';\nimport { storeToRefs } from 'pinia';\nimport { computed, onMounted } from 'vue';\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const store = useShopcartStore();\n    const detailStore = useDetailStore();\n    let {\n      cartList,\n      cartInfoList\n    } = storeToRefs(store);\n    onMounted(() => {\n      store.getCartList();\n    });\n    let totalPrice = computed(() => {\n      let sum = 0;\n      cartInfoList.value.forEach(element => {\n        if (element.isChecked == 1) {\n          sum += element.skuPrice * element.skuNum;\n        }\n      });\n      return sum;\n    });\n    let isAllChecked = computed(() => {\n      return cartInfoList.value.every(item => item.isChecked == 1);\n    });\n\n    function handleCheck(item) {\n      item.isChecked = 1 - item.isChecked;\n    }\n\n    function handleAllChecked() {\n      let a = 1 - isAllChecked.value;\n      cartInfoList.value.forEach(element => {\n        element.isChecked = a;\n      });\n    }\n\n    async function handler(type, disNum, cart) {\n      switch (type) {\n        case 'plus':\n          disNum = 1;\n          break;\n\n        case 'mins':\n          disNum = cart.skuNum > 1 ? -1 : 0;\n          break;\n\n        case 'change':\n          disNum = isNaN(disNum) || disNum < 1 ? 0 : parseInt(disNum) - cart.skuNum;\n          break;\n      }\n\n      try {\n        await detailStore.addOrUpdateShopCar(cart.skuId, disNum);\n        store.getCartList();\n      } catch (error) {\n        alert(error.message);\n      }\n    }\n\n    async function deleteCart(skuId) {\n      try {\n        await store.deleteCartById(skuId);\n        store.getCartList();\n      } catch (error) {\n        alert(error.message);\n      }\n    }\n\n    const __returned__ = {\n      store,\n      detailStore,\n      cartList,\n      cartInfoList,\n      totalPrice,\n      isAllChecked,\n      handleCheck,\n      handleAllChecked,\n      handler,\n      deleteCart,\n      useShopcartStore,\n      useDetailStore,\n      storeToRefs,\n      computed,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n});","map":{"version":3,"mappings":"AAiJA,oBAAe;EACbA,IAAI,EAAE;AADO,CAAf;AA5DA,OAAOC,gBAAP,MAA6B,kBAA7B;AACA,OAAOC,cAAP,MAA2B,gBAA3B;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,KAApC;;;;;;IACA,MAAMC,KAAK,GAAGL,gBAAgB,EAA9B;IACA,MAAMM,WAAW,GAAGL,cAAc,EAAlC;IACA,IAAI;MAAEM,QAAF;MAAYC;IAAZ,IAA6BN,WAAW,CAACG,KAAD,CAA5C;IACAD,SAAS,CAAC,MAAM;MACdC,KAAK,CAACI,WAAN;IACD,CAFQ,CAAT;IAGA,IAAIC,UAAU,GAAGP,QAAQ,CAAC,MAAM;MAC9B,IAAIQ,GAAG,GAAG,CAAV;MACAH,YAAY,CAACI,KAAb,CAAmBC,OAAnB,CAA2BC,OAAO,IAAI;QACpC,IAAIA,OAAO,CAACC,SAAR,IAAqB,CAAzB,EAA4B;UAC1BJ,GAAG,IAAIG,OAAO,CAACE,QAAR,GAAmBF,OAAO,CAACG,MAAlC;QACD;MACF,CAJD;MAKA,OAAON,GAAP;IACD,CARwB,CAAzB;IASA,IAAIO,YAAY,GAAGf,QAAQ,CAAC,MAAM;MAChC,OAAOK,YAAY,CAACI,KAAb,CAAmBO,KAAnB,CAAyBC,IAAI,IAAIA,IAAI,CAACL,SAAL,IAAkB,CAAnD,CAAP;IACD,CAF0B,CAA3B;;IAGA,SAASM,WAAT,CAAqBD,IAArB,EAA2B;MACzBA,IAAI,CAACL,SAAL,GAAiB,IAAIK,IAAI,CAACL,SAA1B;IACD;;IACD,SAASO,gBAAT,GAA4B;MAC1B,IAAIC,CAAC,GAAG,IAAIL,YAAY,CAACN,KAAzB;MACAJ,YAAY,CAACI,KAAb,CAAmBC,OAAnB,CAA2BC,OAAO,IAAI;QACpCA,OAAO,CAACC,SAAR,GAAoBQ,CAApB;MACD,CAFD;IAGD;;IACD,eAAeC,OAAf,CAAuBC,IAAvB,EAA6BC,MAA7B,EAAqCC,IAArC,EAA2C;MACzC,QAAQF,IAAR;QACE,KAAK,MAAL;UACEC,MAAM,GAAG,CAAT;UACA;;QACF,KAAK,MAAL;UACEA,MAAM,GAAGC,IAAI,CAACV,MAAL,GAAc,CAAd,GAAkB,CAAC,CAAnB,GAAuB,CAAhC;UACA;;QACF,KAAK,QAAL;UACES,MAAM,GAAIE,KAAK,CAACF,MAAD,CAAL,IAAiBA,MAAM,GAAG,CAA3B,GAAgC,CAAhC,GAAoCG,QAAQ,CAACH,MAAD,CAAR,GAAmBC,IAAI,CAACV,MAArE;UACA;MATJ;;MAWA,IAAI;QACF,MAAMX,WAAW,CAACwB,kBAAZ,CAA+BH,IAAI,CAACI,KAApC,EAA2CL,MAA3C,CAAN;QACArB,KAAK,CAACI,WAAN;MACD,CAHD,CAGE,OAAOuB,KAAP,EAAc;QACdC,KAAK,CAACD,KAAK,CAACE,OAAP,CAAL;MACD;IACF;;IACD,eAAeC,UAAf,CAA0BJ,KAA1B,EAAiC;MAC/B,IAAI;QACF,MAAM1B,KAAK,CAAC+B,cAAN,CAAqBL,KAArB,CAAN;QACA1B,KAAK,CAACI,WAAN;MACD,CAHD,CAGE,OAAOuB,KAAP,EAAc;QACdC,KAAK,CAACD,KAAK,CAACE,OAAP,CAAL;MACD;IACF","names":["name","useShopcartStore","useDetailStore","storeToRefs","computed","onMounted","store","detailStore","cartList","cartInfoList","getCartList","totalPrice","sum","value","forEach","element","isChecked","skuPrice","skuNum","isAllChecked","every","item","handleCheck","handleAllChecked","a","handler","type","disNum","cart","isNaN","parseInt","addOrUpdateShopCar","skuId","error","alert","message","deleteCart","deleteCartById"],"sources":["D:/web/Vue/shop/src/pages/ShopCart/index.vue"],"sourcesContent":["<template>\r\n  <TypeNav></TypeNav>\r\n  <div class=\"cart\">\r\n    <h4>全部商品</h4>\r\n    <div class=\"cart-main\">\r\n      <div class=\"cart-th\">\r\n        <div class=\"cart-th1\">全部</div>\r\n        <div class=\"cart-th2\">商品</div>\r\n        <div class=\"cart-th3\">单价（元）</div>\r\n        <div class=\"cart-th4\">数量</div>\r\n        <div class=\"cart-th5\">小计（元）</div>\r\n        <div class=\"cart-th6\">操作</div>\r\n      </div>\r\n      <div class=\"cart-body\">\r\n        <ul class=\"cart-list\" v-if=\"!cartInfoList[0]\">\r\n          <div class=\"empty\">\r\n            <div class=\"item\">\r\n              <div class=\"left\">\r\n                <img src=\"./images/cartEmpty.png\" alt=\"\">\r\n              </div>\r\n              <div class=\"right\">\r\n                <div> 购物车空空的哦~，去看看心仪的商品吧~</div><br>\r\n                <a>去购物></a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ul>\r\n        <ul class=\"cart-list\" v-for=\"item in cartInfoList\" :key=\"item.id\">\r\n          <li class=\"cart-list-con1\">\r\n            <input type=\"checkbox\" name=\"chk_list\" :checked=\"item.isChecked == 1\" @change=\"handleCheck(item)\">\r\n          </li>\r\n          <li class=\"cart-list-con2\">\r\n            <img :src=\"item.imgUrl\">\r\n            <div class=\"item-msg\">{{ item.skuName }}</div>\r\n          </li>\r\n          <li class=\"cart-list-con3\">\r\n            <div class=\"item-txt\">官方标配</div>\r\n          </li>\r\n          <li class=\"cart-list-con4\">\r\n            <span class=\"price\">{{ item.skuPrice }}</span>\r\n          </li>\r\n          <li class=\"cart-list-con5\">\r\n            <a href=\"javascript:void(0)\" class=\"mins\" @click=\"handler('mins', -1, item)\">-</a>\r\n            <input autocomplete=\"off\" type=\"number\" :value=\"item.skuNum\" minnum=\"1\" class=\"itxt\"\r\n              @change=\"handler('change', $event.target.value * 1, item)\">\r\n            <a href=\"javascript:void(0)\" class=\"plus\" @click=\"handler('plus', 1, item)\">+</a>\r\n          </li>\r\n          <li class=\"cart-list-con6\">\r\n            <span class=\"sum\">{{ item.skuPrice * item.skuNum }}</span>\r\n          </li>\r\n          <li class=\"cart-list-con7\">\r\n            <a href=\"javascript:void(0)\" class=\"sindelet\" @click=\"deleteCart(item.skuId)\">删除</a>\r\n            <br>\r\n            <a href=\"#none\">移到收藏</a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"cart-tool\">\r\n      <div class=\"select-all\">\r\n        <input class=\"chooseAll\" type=\"checkbox\" :checked=\"isAllChecked\" @change=\"handleAllChecked\">\r\n        <span>全选</span>\r\n      </div>\r\n      <div class=\"option\">\r\n        <a href=\"#none\">删除选中的商品</a>\r\n        <a href=\"#none\">移到我的关注</a>\r\n        <a href=\"#none\">清除下柜商品</a>\r\n      </div>\r\n      <div class=\"money-box\">\r\n        <div class=\"chosed\">已选择\r\n          <span>0</span>件商品\r\n        </div>\r\n        <div class=\"sumprice\">\r\n          <em>总价（不含运费） ：</em>\r\n          <i class=\"summoney\">{{ totalPrice }}</i>\r\n        </div>\r\n        <div class=\"sumbtn\">\r\n          <a class=\"sum-btn\" href=\"###\" target=\"_blank\">结算</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport useShopcartStore from '@/store/Shopcart'\r\nimport useDetailStore from '@/store/Detail'\r\nimport { storeToRefs } from 'pinia'\r\nimport { computed, onMounted } from 'vue';\r\nconst store = useShopcartStore()\r\nconst detailStore = useDetailStore()\r\nlet { cartList, cartInfoList } = storeToRefs(store)\r\nonMounted(() => {\r\n  store.getCartList()\r\n})\r\nlet totalPrice = computed(() => {\r\n  let sum = 0\r\n  cartInfoList.value.forEach(element => {\r\n    if (element.isChecked == 1) {\r\n      sum += element.skuPrice * element.skuNum\r\n    }\r\n  })\r\n  return sum\r\n})\r\nlet isAllChecked = computed(() => {\r\n  return cartInfoList.value.every(item => item.isChecked == 1)\r\n})\r\nfunction handleCheck(item) {\r\n  item.isChecked = 1 - item.isChecked\r\n}\r\nfunction handleAllChecked() {\r\n  let a = 1 - isAllChecked.value\r\n  cartInfoList.value.forEach(element => {\r\n    element.isChecked = a\r\n  });\r\n}\r\nasync function handler(type, disNum, cart) {\r\n  switch (type) {\r\n    case 'plus':\r\n      disNum = 1\r\n      break\r\n    case 'mins':\r\n      disNum = cart.skuNum > 1 ? -1 : 0\r\n      break\r\n    case 'change':\r\n      disNum = (isNaN(disNum) || disNum < 1) ? 0 : parseInt(disNum) - cart.skuNum\r\n      break\r\n  }\r\n  try {\r\n    await detailStore.addOrUpdateShopCar(cart.skuId, disNum)\r\n    store.getCartList()\r\n  } catch (error) {\r\n    alert(error.message)\r\n  }\r\n}\r\nasync function deleteCart(skuId) {\r\n  try {\r\n    await store.deleteCartById(skuId)\r\n    store.getCartList()\r\n  } catch (error) {\r\n    alert(error.message)\r\n  }\r\n}\r\n</script>\r\n<script>\r\nexport default {\r\n  name: 'ShopCart',\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\ninput::-webkit-outer-spin-button,\r\ninput::-webkit-inner-spin-button {\r\n  -webkit-appearance: none;\r\n}\r\n\r\ninput[type=\"number\"] {\r\n  -moz-appearance: textfield;\r\n  outline: none;\r\n}\r\n\r\n.empty {\r\n  margin: 0 auto;\r\n\r\n  .item {\r\n    margin: 0 500px;\r\n\r\n    .left {\r\n      float: left !important;\r\n    }\r\n\r\n    .right {\r\n      float: left;\r\n\r\n      div {\r\n        width: 300px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.cart {\r\n  width: 1200px;\r\n  margin: 0 auto;\r\n\r\n  h4 {\r\n    margin: 9px 0;\r\n    font-size: 14px;\r\n    line-height: 21px;\r\n  }\r\n\r\n  .cart-main {\r\n    .cart-th {\r\n      background: #f5f5f5;\r\n      border: 1px solid #ddd;\r\n      padding: 10px;\r\n      overflow: hidden;\r\n\r\n      &>div {\r\n        float: left;\r\n      }\r\n\r\n      .cart-th1 {\r\n        width: 25%;\r\n\r\n        input {\r\n          vertical-align: middle;\r\n        }\r\n\r\n        span {\r\n          vertical-align: middle;\r\n        }\r\n      }\r\n\r\n      .cart-th2 {\r\n        width: 25%;\r\n      }\r\n\r\n      .cart-th3,\r\n      .cart-th4,\r\n      .cart-th5,\r\n      .cart-th6 {\r\n        width: 12.5%;\r\n\r\n      }\r\n    }\r\n\r\n    .cart-body {\r\n      margin: 15px 0;\r\n      border: 1px solid #ddd;\r\n\r\n      .cart-list {\r\n        padding: 10px;\r\n        border-bottom: 1px solid #ddd;\r\n        overflow: hidden;\r\n\r\n        &>li {\r\n          float: left;\r\n        }\r\n\r\n        .cart-list-con1 {\r\n          width: 4.1667%;\r\n        }\r\n\r\n        .cart-list-con2 {\r\n          width: 30%;\r\n\r\n          img {\r\n            width: 82px;\r\n            height: 82px;\r\n            float: left;\r\n          }\r\n\r\n          .item-msg {\r\n            float: left;\r\n            width: 230px;\r\n            margin: 0 20px;\r\n            line-height: 18px;\r\n          }\r\n        }\r\n\r\n        .cart-list-con3 {\r\n          width: 15.8333%;\r\n\r\n          .item-txt {\r\n            text-align: center;\r\n          }\r\n        }\r\n\r\n        .cart-list-con4 {\r\n          width: 12.5%;\r\n\r\n        }\r\n\r\n        .cart-list-con5 {\r\n          width: 12.5%;\r\n\r\n          .mins {\r\n            border: 1px solid #ddd;\r\n            border-right: 0;\r\n            float: left;\r\n            color: #666;\r\n            width: 6px;\r\n            text-align: center;\r\n            padding: 8px;\r\n          }\r\n\r\n          input {\r\n            border: 1px solid #ddd;\r\n            width: 40px;\r\n            height: 33px;\r\n            float: left;\r\n            text-align: center;\r\n            font-size: 14px;\r\n          }\r\n\r\n          .plus {\r\n            border: 1px solid #ddd;\r\n            border-left: 0;\r\n            float: left;\r\n            color: #666;\r\n            width: 6px;\r\n            text-align: center;\r\n            padding: 8px;\r\n          }\r\n        }\r\n\r\n        .cart-list-con6 {\r\n          width: 12.5%;\r\n\r\n          .sum {\r\n            font-size: 16px;\r\n          }\r\n        }\r\n\r\n        .cart-list-con7 {\r\n          width: 12.5%;\r\n\r\n          a {\r\n            color: #666;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .cart-tool {\r\n    overflow: hidden;\r\n    border: 1px solid #ddd;\r\n    margin-bottom: 10px;\r\n\r\n    .select-all {\r\n      padding: 10px;\r\n      overflow: hidden;\r\n      float: left;\r\n      line-height: 34px;\r\n\r\n      span {\r\n        vertical-align: middle;\r\n      }\r\n\r\n      input {\r\n        vertical-align: middle;\r\n      }\r\n    }\r\n\r\n    .option {\r\n      line-height: 34px;\r\n      padding: 10px;\r\n      overflow: hidden;\r\n      float: left;\r\n\r\n      a {\r\n        float: left;\r\n        padding: 0 10px;\r\n        color: #666;\r\n      }\r\n    }\r\n\r\n    .money-box {\r\n      float: right;\r\n\r\n      .chosed {\r\n        line-height: 54px;\r\n        float: left;\r\n        padding: 0 10px;\r\n      }\r\n\r\n      .sumprice {\r\n        width: 200px;\r\n        line-height: 50px;\r\n        float: left;\r\n        padding: 0 10px;\r\n\r\n        .summoney {\r\n          color: #c81623;\r\n          font-size: 16px;\r\n        }\r\n      }\r\n\r\n      .sumbtn {\r\n        float: right;\r\n\r\n        a {\r\n          display: block;\r\n          position: relative;\r\n          width: 96px;\r\n          height: 54px;\r\n          line-height: 54px;\r\n          color: #fff;\r\n          text-align: center;\r\n          font-size: 18px;\r\n          font-family: \"Microsoft YaHei\";\r\n          background: #FF4610;\r\n          overflow: hidden;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}