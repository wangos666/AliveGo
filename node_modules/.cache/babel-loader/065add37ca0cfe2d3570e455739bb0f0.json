{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { defineStore } from \"pinia\";\nimport { reqGetCode, reqRegister, reqLogin, reqGetUserInfo, reqLogOut } from \"@/api\";\nimport { getToken } from \"@/utils/token\";\nexport default defineStore('user', {\n  state: () => {\n    return {\n      code: '',\n      token: getToken(),\n      userInfo: {}\n    };\n  },\n  getters: {\n    name() {\n      return this.userInfo.name;\n    }\n\n  },\n  actions: {\n    getCode(phone) {\n      reqGetCode(phone).then(res => this.code = res.data);\n    },\n\n    async register(params) {\n      let result = await reqRegister(params);\n\n      if (result.code == 200) {\n        return 'ok';\n      } else {\n        return Promise.reject(new Error(result.message));\n      }\n    },\n\n    async login(params) {\n      let result = await reqLogin(params);\n\n      if (result.code == 200) {\n        this.token = result.data.token;\n        localStorage.setItem('token', result.data.token);\n        return 'ok';\n      } else {\n        return Promise.reject(new Error(result.message));\n      }\n    },\n\n    async getUserInfo() {\n      let result = reqGetUserInfo();\n\n      if (result.code == 200) {\n        this.userInfo = result.data;\n        return 'ok';\n      } else {\n        return Promise.reject(new Error('fali'));\n      }\n    },\n\n    async outLogin() {\n      let result = await reqLogOut();\n\n      if (result.code == 200) {\n        localStorage.removeItem('token');\n        this.userInfo = {};\n        this.token = '';\n        return 'ok';\n      } else {\n        return Promise.reject(new Error(result.message));\n      }\n    }\n\n  }\n});","map":{"version":3,"names":["defineStore","reqGetCode","reqRegister","reqLogin","reqGetUserInfo","reqLogOut","getToken","state","code","token","userInfo","getters","name","actions","getCode","phone","then","res","data","register","params","result","Promise","reject","Error","message","login","localStorage","setItem","getUserInfo","outLogin","removeItem"],"sources":["D:/web/Vue/shop/src/store/User/index.js"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport { reqGetCode, reqRegister, reqLogin, reqGetUserInfo, reqLogOut } from \"@/api\";\r\nimport { getToken } from \"@/utils/token\";\r\nexport default defineStore('user', {\r\n    state: () => {\r\n        return {\r\n            code: '',\r\n            token: getToken(),\r\n            userInfo: {}\r\n        }\r\n    },\r\n    getters: {\r\n        name() {\r\n            return this.userInfo.name\r\n        }\r\n    },\r\n    actions: {\r\n        getCode(phone) {\r\n            reqGetCode(phone).then(\r\n                res => this.code = res.data\r\n            )\r\n        },\r\n        async register(params) {\r\n            let result = await reqRegister(params)\r\n            if (result.code == 200) {\r\n                return 'ok'\r\n            } else {\r\n                return Promise.reject(new Error(result.message))\r\n            }\r\n        },\r\n        async login(params) {\r\n            let result = await reqLogin(params)\r\n            if (result.code == 200) {\r\n                this.token = result.data.token\r\n                localStorage.setItem('token', result.data.token)\r\n                return 'ok'\r\n            } else {\r\n                return Promise.reject(new Error(result.message))\r\n            }\r\n        },\r\n        async getUserInfo() {\r\n            let result = reqGetUserInfo()\r\n            if (result.code == 200) {\r\n                this.userInfo = result.data\r\n                return 'ok'\r\n            } else {\r\n                return Promise.reject(new Error('fali'))\r\n            }\r\n        },\r\n        async outLogin() {\r\n            let result = await reqLogOut()\r\n            if (result.code == 200) {\r\n                localStorage.removeItem('token')\r\n                this.userInfo = {}\r\n                this.token = ''\r\n                return 'ok'\r\n            } else {\r\n                return Promise.reject(new Error(result.message))\r\n            }\r\n\r\n        }\r\n    }\r\n})"],"mappings":";AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,UAAT,EAAqBC,WAArB,EAAkCC,QAAlC,EAA4CC,cAA5C,EAA4DC,SAA5D,QAA6E,OAA7E;AACA,SAASC,QAAT,QAAyB,eAAzB;AACA,eAAeN,WAAW,CAAC,MAAD,EAAS;EAC/BO,KAAK,EAAE,MAAM;IACT,OAAO;MACHC,IAAI,EAAE,EADH;MAEHC,KAAK,EAAEH,QAAQ,EAFZ;MAGHI,QAAQ,EAAE;IAHP,CAAP;EAKH,CAP8B;EAQ/BC,OAAO,EAAE;IACLC,IAAI,GAAG;MACH,OAAO,KAAKF,QAAL,CAAcE,IAArB;IACH;;EAHI,CARsB;EAa/BC,OAAO,EAAE;IACLC,OAAO,CAACC,KAAD,EAAQ;MACXd,UAAU,CAACc,KAAD,CAAV,CAAkBC,IAAlB,CACIC,GAAG,IAAI,KAAKT,IAAL,GAAYS,GAAG,CAACC,IAD3B;IAGH,CALI;;IAML,MAAMC,QAAN,CAAeC,MAAf,EAAuB;MACnB,IAAIC,MAAM,GAAG,MAAMnB,WAAW,CAACkB,MAAD,CAA9B;;MACA,IAAIC,MAAM,CAACb,IAAP,IAAe,GAAnB,EAAwB;QACpB,OAAO,IAAP;MACH,CAFD,MAEO;QACH,OAAOc,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUH,MAAM,CAACI,OAAjB,CAAf,CAAP;MACH;IACJ,CAbI;;IAcL,MAAMC,KAAN,CAAYN,MAAZ,EAAoB;MAChB,IAAIC,MAAM,GAAG,MAAMlB,QAAQ,CAACiB,MAAD,CAA3B;;MACA,IAAIC,MAAM,CAACb,IAAP,IAAe,GAAnB,EAAwB;QACpB,KAAKC,KAAL,GAAaY,MAAM,CAACH,IAAP,CAAYT,KAAzB;QACAkB,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BP,MAAM,CAACH,IAAP,CAAYT,KAA1C;QACA,OAAO,IAAP;MACH,CAJD,MAIO;QACH,OAAOa,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUH,MAAM,CAACI,OAAjB,CAAf,CAAP;MACH;IACJ,CAvBI;;IAwBL,MAAMI,WAAN,GAAoB;MAChB,IAAIR,MAAM,GAAGjB,cAAc,EAA3B;;MACA,IAAIiB,MAAM,CAACb,IAAP,IAAe,GAAnB,EAAwB;QACpB,KAAKE,QAAL,GAAgBW,MAAM,CAACH,IAAvB;QACA,OAAO,IAAP;MACH,CAHD,MAGO;QACH,OAAOI,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,MAAV,CAAf,CAAP;MACH;IACJ,CAhCI;;IAiCL,MAAMM,QAAN,GAAiB;MACb,IAAIT,MAAM,GAAG,MAAMhB,SAAS,EAA5B;;MACA,IAAIgB,MAAM,CAACb,IAAP,IAAe,GAAnB,EAAwB;QACpBmB,YAAY,CAACI,UAAb,CAAwB,OAAxB;QACA,KAAKrB,QAAL,GAAgB,EAAhB;QACA,KAAKD,KAAL,GAAa,EAAb;QACA,OAAO,IAAP;MACH,CALD,MAKO;QACH,OAAOa,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUH,MAAM,CAACI,OAAjB,CAAf,CAAP;MACH;IAEJ;;EA5CI;AAbsB,CAAT,CAA1B"},"metadata":{},"sourceType":"module"}